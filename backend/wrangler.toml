# Top-level configuration
name = "todo-app-worker"
main = "src/index.ts"
compatibility_date = "2025-01-01"
compatibility_flags = ["nodejs_compat"]
# logpush = true

# Durable Objects configuration (temporarily disabled)
# [[durable_objects.bindings]]
# name = "TODO_WEBSOCKET"
# class_name = "TodoWebSocketDurableObject"

# Durable Objects migrations - delete existing Durable Objects
# [[migrations]]
# tag = "v2"
# deleted_classes = ["TodoWebSocketDurableObject"]

# Observability configuration for Wrangler v4
[observability]
enabled = true
# head_sampling_rate = 0.1 # 10% of requests are logged

[observability.traces]
enabled = true
# head_sampling_rate = 0.05

[observability.logs]
enabled = true
# head_sampling_rate = 0.6

# Environment variables configuration
[env.production]
name = "prod-todo-worker"
ENVIRONMENT = "production"
SUPABASE_URL = ""
SUPABASE_ANON_KEY = ""
SUPABASE_SERVICE_ROLE_KEY = ""
LOG_LEVEL = "info"   # "error" | "warn" | "info" | "debug"

[env.staging]
name = "stg-todo-worker"
ENVIRONMENT = "staging"
SUPABASE_URL = ""
SUPABASE_ANON_KEY = ""
SUPABASE_SERVICE_ROLE_KEY = ""
LOG_LEVEL = "debug"   # "error" | "warn" | "info" | "debug"

# Development environment configuration
[env.development]
name = "dev-todo-worker"
ENVIRONMENT = "development"
SUPABASE_URL = "https://your-project.supabase.co"
SUPABASE_ANON_KEY = "your-supabase-anon-key"
SUPABASE_SERVICE_ROLE_KEY = "your-supabase-service-role-key"
LOG_LEVEL = "debug"   # "error" | "warn" | "info" | "debug"